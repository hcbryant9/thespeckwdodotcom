<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <meta property="og:title" content="mono-pixel" />
    <meta name="description" content="pixel art & monochrome" />
    <meta property="og:description" content="pixel art & monochrome" />
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="assets/images/projects/monopixel.png" type="image/png" />
    <link rel="apple-touch-icon" href="assets/images/projects/monopixel.png" type="image/png" />
    
    <link rel="stylesheet" type="text/css" href="main.css">
    <title>mono-pixel</title>
</head>

<style>
    #outputCanvas {
        width: 421px;
        height: 595px;
        max-width: 100%;
        display: block;
        margin: 0 auto;
    }
    #processedImage {
        display: none;
    }


    /* Styling for the visible button */
    
      /* Styling for the hidden file input */
    .hidden-input {
        position: absolute;
        top: -9999px;
        left: -9999px;
    }


</style>

<body>
    
    <!-- Option to take a photograph using the device's camera -->
    <button class="index-btn" onclick="openCamera()">Take Photo</button>

    <label for ="cameraInput" class="hidden-input"></label>
    <input class="hidden-input" type="file" accept="image/*" capture="environment" id="cameraInput" onchange="handleImageUpload(event)">
    <br>
    <br>
    <!-- Option to upload an image from camera roll -->
    <label for ="uploadInput" class="index-btn">Upload Photo</label>
    <input class="hidden-input" type="file" accept="image/*" id="uploadInput" onchange="handleImageUpload(event)">
    <br>
    <br>

    <label for="pixelSizeInput">Pixel Size:</label>
    <input type="number" id="pixelSizeInput" value="16" min="1" max="100">

    <label for="monoThresholdInput">Mono Threshold:</label>
    <input type="number" id="monoThresholdInput" value="128" min="1" max="256">

    <br><br>
    <button class="index-btn" onclick="processImage()">Process Image</button>
    <br>
    
    <!-- Canvas to display processed image -->
    <canvas id="outputCanvas" width="421" height="595"></canvas>
    <img id="processedImage" width="421" height="595">
    <!-- Download button for saving the processed image -->
    <button class="index-btn" onclick="downloadImage()">Download Image</button>
    
    <script src="https://docs.opencv.org/4.5.3/opencv.js"></script>
    <script src="process.js"></script>

    <script>
        function handleImageUpload(event) {
            const canvas = document.getElementById('outputCanvas');
            const ctx = canvas.getContext('2d');

            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = new Image();
                    img.onload = function() {
                        canvas.width = img.width;
                        canvas.height = img.height;
                        ctx.drawImage(img, 0, 0);
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }
    </script>

</body>
</html>
